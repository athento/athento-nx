<c:if test="true"
      xmlns:nxu="http://nuxeo.org/nxweb/util"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:nxl="http://nuxeo.org/nxforms/layout"
      xmlns:a4j="http://richfaces.org/a4j">
 <nxu:set var="routeIdName" value="#{relatedRoute.document.id.split('-')[0]}" cache="true">
    <script type="text/javascript">
        <h:outputText value="var currentLang='#{restHelper.getLocaleString()}';"/>
        <h:outputText value="var divContainerTargetId#{routeIdName}='#{routeIdName}_#{widget.id}_target';"/>
        var content#{routeIdName};
        function showGraph#{routeIdName}(routeId) {
          if (!content#{routeIdName}) content#{routeIdName} = jQuery('##{routeIdName}_div').html();
          jQuery('##{routeIdName}_div').html(content#{routeIdName});
          loadGraph(routeId, currentLang, divContainerTargetId#{routeIdName});
          openFancyBox('##{routeIdName}_#{widget.id}_graphView_box', {
            'autoScale': false,
            'autoDimensions': false,
            'type': 'inline',
            'width': '880',
            'height': '720',
            'transitionIn': 'none',
            'transitionOut': 'none',
            'enableEscapeButton': true,
            'centerOnScroll': true
          });
          return false;
        }
      </script>

    <a href="#" onclick="showGraph#{routeIdName}('#{field_0}');return false;" class="button smallButton">
        #{messages['label.document.routing.show.graph']}
    </a>

    <div id="#{routeIdName}_div">
        <div style="display:none">
            <div id="#{routeIdName}_#{widget.id}_graphView_box">
                <!-- div container for the graph -->
                <div id="#{routeIdName}_#{widget.id}_target" class="targetDiv"></div>
            </div>
        </div>
    </div>

 </nxu:set>

</c:if>
